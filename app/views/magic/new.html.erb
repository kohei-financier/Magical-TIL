<div class="w-full max-w-2xl mx-auto space-y-8">
  <div class="text-center">
    <h1 class="mb-4 text-3xl font-bold tracking-tight text-black dark:text-white sm:text-4xl">Magical TIL</h1>
    <p class="mt-3 text-base text-black/60 dark:text-white/60">あなたが今日学んだ内容（Today I Learned 略称:TIL）を</p>
    <p class="mt-1 text-base text-black/60 dark:text-white/60">魔法使い🧙に報告し、新たな魔法🔮を授かります。</p>
  </div>

  <%= turbo_frame_tag "magic_form" do %>

    <div class="bg-white dark:bg-background-dark rounded-xl shadow-sm border border-black/10 dark:border-white/10">
      <%= form_with url: magic_path do |form| %>
        <div class="p-6">
          <%= form.textarea :my_til, value: params[:my_til], class: "form-textarea w-full resize-none rounded-lg bg-background-light dark:bg-black/20 border-black/10 dark:border-white/20 text-black dark:text-white placeholder:text-black/40 dark:placeholder:text-white/40 focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-200", placeholder: "ex. 今日は「TailwindCSS」について学びました。TailwindCSSは...", rows: "8" %>
        </div>
        <div class="px-6 pb-6 pt-2 flex justify-end">
          <%= form.button class: "flex min-w-[120px] items-center justify-center rounded-lg h-12 px-6 bg-purple-600 text-white text-base font-bold leading-normal tracking-wide shadow-lg shadow-primary/20 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary focus:ring-offset-background-light dark:focus:ring-offset-background-dark transition-all duration-200", id: "be-enchanted-button" do %>
            <span class="material-symbols-outlined mr-2">wand_stars</span>
            魔法を授かる！
          <% end %>
        </div>
      <% end %>
    </div>

    <% if @error_message %>
      <div class="mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
        <strong class="font-bold">エラー:</strong>
        <span class="block sm:inline"><%= @error_message %></span>
      </div>
    <% end %>

    <div id="loading-indicator" class="hidden text-center mt-4">
      <p class="text-gray-600">魔法使い🧙が何やら不思議な呪文を唱えている⋯。</p>
    </div>

    <% if @magic %>

      <div class="w-full max-w-2xl mx-auto space-y-8" data-controller="clipboard">
        <div class="w-full max-w-2xl mx-auto mt-12 bg-parchment text-ancient-ink font-serif border-2 border-sepia-border rounded-lg shadow-inner-lg p-8 relative">
          <div class="absolute top-4 right-4">
            <button data-action="click->clipboard#copy" class="p-2 rounded-full hover:bg-sepia-border/20 transition-colors duration-200" title="内容をコピー">
              <span class="material-symbols-outlined text-ancient-ink/80">content_copy</span>
            </button>
          </div>
          <div class="space-y-6">
            <h2 class="text-sm uppercase tracking-widest text-ancient-ink/70">あなたは今日の学びが認められ、🧙魔法使いから新たな魔法🔮を授かりました</h2>
            <div data-clipboard-target="source">
              <div>
                <h3 class="text-sm uppercase tracking-widest text-ancient-ink/70">🔮New Magic</h3>
                <p class="mt-1 text-2xl font-semibold italic"><%= @magic["newMagicName"] %></p>
              </div>
              <hr class="border-t border-sepia-border my-4"/>
              <div>
                <h3 class="text-sm uppercase tracking-widest text-ancient-ink/70">💭Comment</h3>
                <p class="mt-1 text-base italic leading-relaxed text-ancient-ink/90"><%= @magic["comments"] %></p>
              </div>
            </div>
          </div>
        </div>
      </div>

    <% end %>

  <% end %>

</div>
